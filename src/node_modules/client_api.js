const server = 'http://localhost'
export const login_url = server + '/client/login?service=wiener';
const session_url = server + '/client/api/session_info?service=wiener';
const access_token_url = server + '/client/api/access_token?service=wiener';

function send({ method, path }) {
	const fetch = process.browser ? window.fetch : require('node-fetch').default;

	const opts = { method, headers: {} };
	// opts.headers['Access-Control-Allow-Origin'] = '*';
	
	return fetch(`${path}`, opts)
		.then(r => r.text())
		.then(json => {
			try {
				return JSON.parse(json);
			} catch (err) {
				return json;
			}
		});
}

export function get_session_info() {
	return send({ method: 'GET', path: session_url });
}

export function get_access_token() {
	return send({ method: 'GET', path: access_token_url });
}
